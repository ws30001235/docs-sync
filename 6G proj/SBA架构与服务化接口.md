#### SBA架构

5G核心网基于SBA，从标准一开始就是基于服务化的设计，是云原生架构。5G核心网对网络功能进行了细化，形成了各个NF。SBA采用 IT 化总线，服务模块可自主注册、发布、发现，提高了功能的重用性。3GPP 标准规定了服务接口协议采用`TCP`/`TLS`/`HTTP2`/`JSON`, SBA提供了基于服务化的调用接口，服务化接口基于`TCP`/`HTTP 2.0`进行通信，使用`JSON`作为应用层通信协议的封装。

5G核心网SBA的特征：

- 传统网元被逐渐拆分为若干个自包含、自管理、可重用的网络功能
- 网络功能服务管理自动化，通过NRF实现
  - 网络功能服务的自动注册、更新或去注册：每个网络功能服务在业务加载时会自动向NRF注册本服务的IP地址、域名、支持的能力等信息。在信息变更后自动同步到NRF，在关闭时向NRF进行去注册。NRF维护整个网络内所有网络功能服务的实时信息。
  - 网络功能服务的自动发现和选择：在5G核心网中，每个网络功能服务都会通过NRF来寻找合适的对端服务，而不是依赖本地配置的方式固化通信对端。NRF会根据当前信息向请求者返回对应的响应者网络功能服务列表，供请求者自己选择。这种方式类似于DNS机制，以实现网络功能服务的自动发现和选择。
  - 网络功能服务的状态检测：NRF可以与各网络功能服务之间进行双向定期状态检测，当某个网络功能服务异常时， NRF将异常状态通知到与其相关的网络功能服务。
  - 网络功能服务的认证授权：NRF作为管理类网络功能，需要考虑网络的安全机制，以防止被非法网络功能服务“劫持”业务。
- 网络通信路径优化。在5G核心网的服务化架构下，各网络功能在服务之前可以根据需求随意通信，极大地优化了通信路径。
- 网络功能服务间的交互解耦。5G核心网架构下的网络功能服务间通信机制可进一步解耦为生产者和消费者模式，而不是传统核心网网元之间的点对点模式。

#### 5G系统架构

5G系统架构为服务化架构。5G网络功能由不同的NF提供， NF间相互独立，可以按需部署。

5G系统控制面所有的NF之间交互采用服务化接口（Service Based Interface,SBI）, NF的同一种服务可以通过NF的服务化接口被其他多种NF调用。NF间通过调用彼此的服务化接口实现相应的功能。

![img](https://res.weread.qq.com/wrepub/epub_34740426_36)

NF服务消费者和NF服务生产者之间的交互遵循以下两种机制

（1） 请求—响应模式

（2） 订阅—通知模式

---

#### 3GPP和ONAP接口技术的区别
![image-20220318131959159](C:\Users\Opsuc\AppData\Roaming\Typora\typora-user-images\image-20220318131959159.png)

---

#### ONAP Controllers

ONAP平台用于LCM和CM操作的南向接口是基于控制器的。
控制器是ONAP平台中的组件，连接到云和网络服务，执行配置和实时策略，并控制分布式组件和服务的状态。与其使用一个单一的控制层，运营商可以选择使用多个不同的控制器类型来管理执行环境中的不同资源。执行环境中的不同资源，每个都对应一个不同的域。
ONAP控制器向其他ONAP组件暴露了一个北向API，允许它们对VNF发起活动 (有效的命令)在VNFs和/或PNFs上。ONAP控制器通过网络和应用适配器与xNFs进行南向互动，以执行配置和其他应用适配器与xNFs进行南向互动，以便对xNFs执行配置和其他生命周期管理活动。
在ONAP中，有以下控制器可用。

- 应用控制器（APPC）

  - 它的主要功能是控制VNF和VNFC的生命周期。APPC可以使用几个适配器中的一个来连接到VNF。

  - APPC包含对以下接口协议的适配器。（对应的文件格式是XML或JSON）
    - 带有可上传的Yang模型的Netconf（需要在VNF上运行Netconf服务器）。
    - Chef（需要在VNF上运行Chef客户端）。
    - Ansible（对VNF软件没有要求）

- 软件定义的网络控制器（SDNC）

- 虚拟功能控制器（VF-C）

  - VF-C是ETSI NFV-MANO堆栈的实现，并通过Os-Ma-nfvo、Ve-Vnfm-em和Ve-Vnfm-vnf参考点向ETSI兼容的VNF提供LCM接口

---
网络切片管理功能结构如图所示。

![img](https://res.weread.qq.com/wrepub/epub_34740426_66)

网络切片技术可以让运营商在一个硬件基础设施中切分出多个虚拟的端到端网络，每个网络切片在设备、接入网、传输网以及核心网方面实现逻辑隔离，适配各种类型服务并满足用户的不同需求。

---

网络切片分层管理示意如图所示。

![img](https://res.weread.qq.com/wrepub/epub_34740426_83)

- 通信服务管理（Communication Service Management Function,CSMF）可实现业务需求到网络切片需求的映射。

- 网络切片管理（Network Slice Management Function,NSMF）可实现NSI的编排管理，并将整个切片的SLA分解为切片子网的SLA。

- 网络切片子网管理（Network Slice Subnet Management Function,NSSMF）可实现NSSI的管理和编排，将SLA映射为网络服务实例和配置要求，并将指令下达给MANO执行。

---

网络切片的生命周期管理如图所示。

![img](https://res.weread.qq.com/wrepub/epub_34740426_84)

---

网络切片NSI生成示意如图所示。

![img](https://res.weread.qq.com/wrepub/epub_34740426_86)

NSI生成的具体步骤如下所述。

（1）NSMF收到网络切片的相关需求，如果现有的NSI可以共享，则NSMF使用共享的NSI；如果没有，则新建一个NSI。

（2）NSMF根据需求产生网络切片子网需求和TN网络需求。

（3）NSMF向NSSMF请求NSSI,NSSMF向NSMF反馈NSSI信息。

（4）NSMF向TN网管发送需求，TN网管向NSMF发送响应消息。

（5）NSMF触发指令建立NSSIs之间的关系。

---

### 路由方案

##### 信令面路由方案

5G核心网基于SBA架构，网元之间采用基于HTTP、TCP、IP协议栈的服务化接口并引入NRF网元，各网元主动向NRF发起注册并上报自己所负责的业务能力范围（例如，S-NSSAI、用户号码段、DNN等）和路由寻址信息（例如，FQDN、IP地址等），由NRF提供网络功能和服务的注册、发现、网络服务的授权等服务。5G核心网可采用两级NRF架构组网，即省级（L-NRF）与骨干级（H-NRF）两级NRF架构。其中， L-NRF负责省内控制面网元的注册与发现，而H-NRF负责转接省间的网元发现查询与应答。

网元间的HTTP信令路由根据是否设置了HTTP Proxy有两种路由方式，具体信令路由方式根据运营商的网络部署情况来确定。

两种方式信令路由示意如图所示。

![img](https://res.weread.qq.com/wrepub/epub_34740426_184)

---

